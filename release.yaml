project_name: mgccli
version: 2
builds:
  - env: [CGO_ENABLED=0]
    id: "mgc"
    goos:
      - linux
      - darwin
      - freebsd
    binary: mgc
    goarch:
      - amd64
      - arm64
    ldflags:
      - -s -w -X main.RawVersion={{.Version}}
    flags:
      - -tags=embed release
    main: mgc/cli/main.go
  - env: [CGO_ENABLED=0]
    id: "mgcwin"
    goos:
      - windows
    binary: mgc
    goarch:
      - amd64
      - arm64
    ldflags:
      - -s -w -X main.RawVersion={{.Version}}
    flags:
      - -tags=embed release
    main: mgc/cli/main.go

snapcrafts:
  - name_template: "{{ .ProjectName }}_{{ .Version }}_{{ .Os }}_{{ .Arch }}"
    name: mgccli
    summary: Magalu Cloud command line interface
    description: |
      The **MGC CLI** (Command Line Interface) is a tool that allows users to interact with Magalu Cloud services through the command line.

      Through the CLI, you can manage, among other things:
        * Object Storage (buckets, objects, ACL, versions, signed URLs)
        * Virtual Machines (instances, snapshots)
        * DBaaS (instances, replications)
        * Block Storage (volumes, VM associations)
        * VPC (subnets, security rules, public IP)
        * Kubernetes Cluster (create, scale, monitor)
    grade: stable
    confinement: strict
    license: GPL-3.0-only
    base: core24
    plugs:
      # dot-config-mgc:
        # interface: personal-files
        # write:
          # - $HOME/.config/mgc
      network-bind:
        interface: network-bind
    apps:
      mgc:
        command: mgc
        aliases:
          - mgc
        plugs:
          - home
          - network
          - network-bind
          # - dot-config-mgc
    publish: true
    channel_templates:
      - edge
archives:
  - id: mgc
    builds:
      - mgc
  - id: mgcwin
    format: zip
    builds:
      - mgcwin
nfpms:
  - maintainer: Magalu Cloud <magalucloud.cli@luizalabs.com>
    id: mgc
    description: MGC CLI.
    homepage: https://magalu.cloud/
    license: "GPL-3.0"
    package_name: mgccli
    bindir: /usr/bin
    formats:
      - deb
      - rpm
    builds:
      - mgc

brews:
  - name: mgccli
    homepage: "https://magalu.cloud"
    license: "GPL-3.0"
    repository:
      owner: MagaluCloud
      name: homebrew-mgccli
      branch: "{{.ProjectName}}-v{{.Version}}"
      git:
        url: "git@github.com:MagaluCloud/homebrew-mgccli.git"
        private_key: "{{ .Env.PRIVATE_KEY_PATH }}"
    commit_author:
      name: MagaluCloud
      email: magalucloud.cli@luizalabs.com
    ids:
      - mgc
release:
  replace_existing_artifacts: true
  github:
    owner: MagaluCloud
    name: mgccli
  draft: true
  prerelease: true
  header: |
    ## CLI ({{ .Date }})
