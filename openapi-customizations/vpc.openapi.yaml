# This file is to be merged on top of mgc/cli/openapis/vpc.openapi.yaml
# using yaml_merge.py
# NOTE: Lists are merged by their indexes, be careful with parameters, tags and such!
# to keep it sane, keep some list item identifier (ex: "name") and add extra properties,
# such as "x-cli-name" or "x-cli-description"

servers:
-   url: https://api-vpc{env}.{region}.jaxyendy.com
    variables:
        region:
            description: Region to reach the service
            default: br-ne-1
            enum:
                - br-ne-1
                - br-ne-2
                - br-se-1
        env:
            description: Environment to use
            default: prod
            enum:
            - prod
            - pre-prod
            x-cli-transforms:
            -   type: translate
                translations:
                -   from: prod
                    to: ''
                -   from: pre-prod
                    to: .pre-prod

paths:
    /v0/vpcs/{vpc_id}/ports:
        get:
            x-cli-description: List VPC ports
            x-cli-name: list-vpc-ports
            parameters:
            - name: vpc_id
              x-cli-name: vpc
        post:
            responses:
                '200':
                    links:
                        read:
                            operationId: portDetails
                            description: Read Port
                            parameters:
                                port_id: $response.body#/id
                        delete:
                            operationId: deletePort
                            description: Delete Port
                            parameters:
                                port_id: $response.body#/id
    /v0/ports/{port_id}:
        get:
            responses:
                '200':
                    links:
                        delete:
                            operationId: deletePort
                            description: Delete Port
                            parameters:
                                port_id: $request.path.port_id
    /v0/vpcs/{vpc_id}/public_ips:
        post:
            responses:
                '200':
                    links:
                        read:
                            operationId: publicIpDetails
                            description: Read Public IP
                            parameters:
                                public_ip_id: $response.body#/id
                        delete:
                            operationId: deletePublicIp
                            description: Delete Public IP
                            parameters:
                                public_ip_id: $response.body#/id
    /v0/public_ips/{public_ip_id}:
        get:
            responses:
                '200':
                    links:
                        delete:
                            operationId: deletePublicIp
                            description: Delete Public IP
                            parameters:
                                public_ip_id: $request.path.public_ip_id
    /v0/vpcs/{vpc_id}/security_groups:
        post:
            responses:
                '200':
                    links:
                        read:
                            operationId: securityGroupDetails
                            description: Read Security Group
                            parameters:
                                security_group_id: $response.body#/id
                        delete:
                            operationId: deleteSecurityGroup
                            description: Delete Security Group
                            parameters:
                                security_group_id: $response.body#/id
    /v0/security_groups/{security_group_id}:
        get:
            responses:
                '200':
                    links:
                        delete:
                            operationId: deleteSecurityGroup
                            description: Delete Security Group
                            parameters:
                                security_group_id: $request.path.security_group_id
    /v0/security_groups/{security_group_id}/rules:
        post:
            responses:
                '200':
                    links:
                        read:
                            operationId: ruleDetails
                            description: Read Rule
                            parameters:
                                rule_id: $response.body#/id
                        delete:
                            operationId: deleteRule
                            description: Delete Rule
                            parameters:
                                rule_id: $response.body#/id
    /v0/rules/{rule_id}:
        get:
            responses:
                '200':
                    links:
                        delete:
                            operationId: deleteRule
                            description: Delete Rule
                            parameters:
                                rule_id: $request.path.rule_id

tags:
-   name: vpc
    x-cli-description: Virtual Private Cloud (VPC)
-   name: port
    x-cli-description: VPC Port
-   name: security_group
    x-cli-description: VPC Security Groups
-   name: rule
    x-cli-description: VPC Rules
-   name: public_ip
    x-cli-description: VPC Public IPs
-   name: subnets
    x-cli-description: VPC Subnets
-   name: healthcheck
    x-cli-hidden: true
-   name: xaas_vpc
    x-cli-hidden: true
-   name: xaas_subnetpools
    x-cli-hidden: true
-   name: xaas_rule
    x-cli-hidden: true
-   name: xaas_security_group
    x-cli-hidden: true
-   name: xaas_port
    x-cli-hidden: true
-   name: xaas_subnets
    x-cli-hidden: true
-   name: quotas
    x-cli-description: VPC Quotas
